<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trilium Web Clipper Options</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <h1>‚öô Trilium Web Clipper Options</h1>
    
    <form id="options-form">
      <div class="form-group">
        <label for="trilium-url">Trilium Server URL:</label>
        <input type="url" id="trilium-url" placeholder="http://localhost:8080" required>
        <small>Enter the URL of your Trilium server (e.g., http://localhost:8080)</small>
      </div>

      <div class="form-group">
        <label for="default-title">Default Note Title Template:</label>
        <input type="text" id="default-title" placeholder="Web Clip - {title}" required>
        <small>Use {title} for page title, {url} for page URL, {date} for current date</small>
      </div>

      <div class="form-group">
        <label>
          <input type="checkbox" id="auto-save"> Enable auto-save for selections
        </label>
      </div>

      <div class="form-group">
        <label>
          <input type="checkbox" id="enable-toasts" checked> Show toast notifications
        </label>
      </div>

      <div class="form-group">
        <label for="toast-duration">Toast notification duration:</label>
        <div class="duration-control">
          <input type="range" id="toast-duration" min="1000" max="10000" step="500" value="3000">
          <span id="toast-duration-value">3.0s</span>
        </div>
        <small>How long toast notifications stay on screen (1-10 seconds)</small>
      </div>

      <div class="form-group">
        <label>
          <input type="checkbox" id="enable-meta-note-prompt"> Prompt for personal note when saving
        </label>
        <small>Ask "Why is this clip interesting?" before saving content (inspired by Delicious bookmarks)</small>
      </div>

      <div class="form-group">
        <label for="screenshot-format">Screenshot Format:</label>
        <select id="screenshot-format">
          <option value="png">PNG (Higher Quality)</option>
          <option value="jpeg">JPEG (Smaller Size)</option>
        </select>
      </div>

      <div class="actions">
        <button type="button" id="view-logs" class="secondary-btn">View Extension Logs</button>
        <button type="button" id="test-connection" class="secondary-btn">Test Connection</button>
        <button type="submit">Save Settings</button>
      </div>
    </form>

    <div class="theme-section">
      <h3>‚óê Theme Settings</h3>
      <div class="theme-options">
        <label class="theme-option">
          <input type="radio" name="theme" value="light">
          <span>‚òÄ Light</span>
        </label>
        <label class="theme-option">
          <input type="radio" name="theme" value="dark">
          <span>‚òΩ Dark</span>
        </label>
        <label class="theme-option">
          <input type="radio" name="theme" value="system">
          <span>‚Üª Follow System</span>
        </label>
      </div>
      <p class="help-text">Choose your preferred theme. System follows your operating system's theme setting.</p>
    </div>

    <div class="content-format-section">
      <h3>üìÑ Content Format</h3>
      <p>Choose how to save clipped content:</p>
      <div class="format-options">
        <label class="format-option">
          <input type="radio" name="contentFormat" value="html" checked>
          <div class="format-details">
            <strong>HTML</strong>
            <span class="format-description">Human-readable with styling - best for reading in Trilium</span>
          </div>
        </label>
        <label class="format-option">
          <input type="radio" name="contentFormat" value="markdown">
          <div class="format-details">
            <strong>Markdown</strong>
            <span class="format-description">AI/LLM-friendly format - best for use with ChatGPT, Claude, etc.</span>
          </div>
        </label>
        <label class="format-option">
          <input type="radio" name="contentFormat" value="both">
          <div class="format-details">
            <strong>Both</strong>
            <span class="format-description">HTML + Markdown child note - maximum flexibility (recommended!)</span>
          </div>
        </label>
      </div>
      <p class="help-text">
        <strong>Tip:</strong> The "Both" option creates an HTML note for reading and a markdown child note perfect for AI tools.
      </p>
    </div>

    <div class="code-block-preservation-section">
      <h3>üíª Code Block Preservation</h3>
      <p>Preserve code blocks in their original positions when clipping technical articles.</p>
      
      <div class="feature-description">
        <p class="help-text">
          When enabled, code examples from technical sites like Stack Overflow, GitHub, and dev blogs 
          will remain in their correct positions within the text instead of being removed or relocated.
        </p>
      </div>

      <div class="settings-link-container">
        <a href="codeblock-allowlist.html" class="settings-link">
          <span class="link-icon">‚öô</span>
          <div class="link-content">
            <strong>Configure Allow List</strong>
            <span class="link-description">Manage which websites preserve code blocks</span>
          </div>
          <span class="link-arrow">‚Üí</span>
        </a>
      </div>
    </div>

    <div class="datetime-format-section">
      <h3>üìÖ Date/Time Format</h3>
      <p>Choose how dates and times are formatted when saving notes:</p>
      
      <div class="format-type-selection">
        <label class="format-type-option">
          <input type="radio" name="dateTimeFormat" value="preset" checked>
          <span>Use Preset Format</span>
        </label>
        <label class="format-type-option">
          <input type="radio" name="dateTimeFormat" value="custom">
          <span>Custom Format</span>
        </label>
      </div>

      <div id="preset-format-container" class="format-container">
        <label for="datetime-preset">Select Preset:</label>
        <select id="datetime-preset" class="format-select">
          <option value="iso">ISO 8601 (YYYY-MM-DD)</option>
          <option value="iso-time">ISO with Time (YYYY-MM-DD HH:mm:ss)</option>
          <option value="us">US Format (MM/DD/YYYY)</option>
          <option value="us-time">US with Time (MM/DD/YYYY hh:mm A)</option>
          <option value="eu">European (DD/MM/YYYY)</option>
          <option value="eu-time">European with Time (DD/MM/YYYY HH:mm)</option>
          <option value="long">Long Format (MMMM DD, YYYY)</option>
          <option value="long-time">Long with Time (MMMM DD, YYYY at HH:mm)</option>
          <option value="short">Short Format (MMM DD, YYYY)</option>
          <option value="timestamp">Unix Timestamp</option>
          <option value="relative">Relative (e.g., "2 days ago")</option>
        </select>
      </div>

      <div id="custom-format-container" class="format-container" style="display: none;">
        <label for="datetime-custom">Custom Format String:</label>
        <input type="text" id="datetime-custom" placeholder="YYYY-MM-DD HH:mm:ss" class="format-input">
        <div class="format-help">
          <button type="button" id="format-help-toggle" class="help-button" title="Show format tokens">
            <span class="help-icon">?</span> Format Guide
          </button>
          <div id="format-cheatsheet" class="format-cheatsheet" style="display: none;">
            <h4>Format Tokens:</h4>
            <div class="token-grid">
              <div class="token-item"><code>YYYY</code> - Full year (2025)</div>
              <div class="token-item"><code>YY</code> - 2-digit year (25)</div>
              <div class="token-item"><code>MMMM</code> - Full month (November)</div>
              <div class="token-item"><code>MMM</code> - Short month (Nov)</div>
              <div class="token-item"><code>MM</code> - 2-digit month (11)</div>
              <div class="token-item"><code>M</code> - Month (11)</div>
              <div class="token-item"><code>DD</code> - 2-digit day (08)</div>
              <div class="token-item"><code>D</code> - Day (8)</div>
              <div class="token-item"><code>HH</code> - 24-hour (14)</div>
              <div class="token-item"><code>hh</code> - 12-hour (02)</div>
              <div class="token-item"><code>mm</code> - Minutes (30)</div>
              <div class="token-item"><code>ss</code> - Seconds (45)</div>
              <div class="token-item"><code>A</code> - AM/PM</div>
            </div>
            <p class="help-note">Example: <code>YYYY-MM-DD HH:mm:ss</code> ‚Üí 2025-11-08 14:30:45</p>
          </div>
        </div>
      </div>

      <div class="format-preview">
        <strong>Preview:</strong> <span id="format-preview-text">2025-11-08</span>
      </div>

      <p class="help-text">
        This format applies to publishedDate and modifiedDate labels extracted from web pages.
      </p>
    </div>

    <div class="shortcuts-section">
      <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
      <p>Current keyboard shortcuts for the extension. Click the button below to customize them in your browser settings.</p>

      <div class="shortcut-item">
        <label>Save selection:</label>
        <div class="shortcut-display">
          <kbd id="shortcut-save-selection">Not set</kbd>
        </div>
      </div>

      <div class="shortcut-item">
        <label>Save page:</label>
        <div class="shortcut-display">
          <kbd id="shortcut-save-page">Not set</kbd>
        </div>
      </div>

      <div class="shortcut-item">
        <label>Save screenshot:</label>
        <div class="shortcut-display">
          <kbd id="shortcut-save-screenshot">Not set</kbd>
        </div>
      </div>

      <div class="shortcut-item">
        <label>Save all tabs:</label>
        <div class="shortcut-display">
          <kbd id="shortcut-save-tabs">Not set</kbd>
        </div>
      </div>

      <div class="shortcut-actions">
        <button type="button" id="open-shortcuts-settings" class="primary-btn">
          ‚öô Configure Shortcuts in Browser
        </button>
        <p id="shortcuts-help-text" class="help-text">Opens your browser's extension shortcut settings page</p>
      </div>
    </div>

    <div class="test-section">
      <h3>‚ü≤ Connection Test</h3>
      <p>Test your connection to the Trilium server:</p>
      <div id="connection-status" class="connection-indicator disconnected">
        <span class="status-dot"></span>
        <span id="connection-text">Not tested</span>
      </div>
    </div>

    <div id="status" class="status-message" style="display: none;"></div>
  </div>

  <script type="module" src="./options.ts"></script>
</body>
</html>